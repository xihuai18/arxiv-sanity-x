{% extends "base.html" %}

{% block variables %}
<script>
var statsData = {
    total: {{ num_papers }},
    flow: [
        { label: '1h', value: {{ thr_1 }}, color: '#ef4444' },
        { label: '6h', value: {{ thr_6 }}, color: '#f97316' },
        { label: '12h', value: {{ thr_12 }}, color: '#eab308' },
        { label: '24h', value: {{ thr_24 }}, color: '#84cc16' },
        { label: '48h', value: {{ thr_48 }}, color: '#22c55e' },
        { label: '72h', value: {{ thr_72 }}, color: '#14b8a6' },
        { label: '96h', value: {{ thr_96 }}, color: '#06b6d4' },
        { label: 'Week', value: {{ thr_week }}, color: '#3b82f6' },
        { label: 'Month', value: {{ thr_month }}, color: '#6366f1' },
        { label: 'Quarter', value: {{ thr_quarter }}, color: '#8b5cf6' },
        { label: '6 Months', value: {{ thr_semiannual }}, color: '#a855f7' },
        { label: 'Year', value: {{ thr_year }}, color: '#ec4899' }
    ]
};
</script>
{% endblock %}

{% block content %}
<div id="statswrap" class="stats-container">
    <!-- Overview Cards -->
    <div class="stats-overview">
        <div class="stats-card stats-card-primary">
            <div class="stats-card-content">
                <span class="stats-card-value">{{ num_papers }}</span>
                <span class="stats-card-label">Total Papers</span>
            </div>
        </div>
        <div class="stats-card">
            <div class="stats-card-content">
                <span class="stats-card-value stats-card-value-small">{{ earliest_paper }}</span>
                <span class="stats-card-label">Earliest Paper</span>
            </div>
        </div>
        <div class="stats-card">
            <div class="stats-card-content">
                <span class="stats-card-value stats-card-value-small">{{ latest_paper }}</span>
                <span class="stats-card-label">Latest Paper</span>
            </div>
        </div>
    </div>

    <!-- Paper Flow Section -->
    <div class="stats-section">
        <h2 class="stats-section-title">Paper Flow</h2>
        <p class="stats-section-desc">Number of new papers indexed over different time periods</p>

        <!-- Visual Bar Chart -->
        <div class="stats-chart">
            {% set max_val = [thr_1, thr_6, thr_12, thr_24, thr_48, thr_72, thr_96, thr_week, thr_month, thr_quarter, thr_semiannual, thr_year] | max %}

            <div class="stats-bar-group">
                <div class="stats-bar-item">
                    <div class="stats-bar-label">1 Hour</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_1 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #94a3b8;">
                            <span class="stats-bar-value">{{ thr_1 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">6 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_6 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #8ca0b6;">
                            <span class="stats-bar-value">{{ thr_6 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">12 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_12 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #8197ad;">
                            <span class="stats-bar-value">{{ thr_12 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">24 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_24 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #778da3;">
                            <span class="stats-bar-value">{{ thr_24 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">48 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_48 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #6f8499;">
                            <span class="stats-bar-value">{{ thr_48 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">72 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_72 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #677b90;">
                            <span class="stats-bar-value">{{ thr_72 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">96 Hours</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_96 / max_val * 100) if max_val > 0 else 0 }}%; background-color: #5f7286;">
                            <span class="stats-bar-value">{{ thr_96 }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">1 Week</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_week / max_val * 100) if max_val > 0 else 0 }}%; background-color: #586a7d;">
                            <span class="stats-bar-value">{{ thr_week }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">1 Month</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_month / max_val * 100) if max_val > 0 else 0 }}%; background-color: #506174;">
                            <span class="stats-bar-value">{{ thr_month }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">3 Months</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_quarter / max_val * 100) if max_val > 0 else 0 }}%; background-color: #48586b;">
                            <span class="stats-bar-value">{{ thr_quarter }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">6 Months</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_semiannual / max_val * 100) if max_val > 0 else 0 }}%; background-color: #414f62;">
                            <span class="stats-bar-value">{{ thr_semiannual }}</span>
                        </div>
                    </div>
                </div>
                <div class="stats-bar-item">
                    <div class="stats-bar-label">1 Year</div>
                    <div class="stats-bar-track">
                        <div class="stats-bar-fill" style="width: {{ (thr_year / max_val * 100) if max_val > 0 else 0 }}%; background-color: #3a4659;">
                            <span class="stats-bar-value">{{ thr_year }}</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block elements %}
{% endblock %}
